<!DOCTYPE html>
<html>
<head>
</head>
<body>

<button id="openGrantPage" type="button">Click Me!</button>

<script>
    document.getElementById("openGrantPage").onclick = function () {
        var OAuthUrl = "https://accounts.google.com/o/oauth2/v2/auth?";
        var scope = "https://mail.google.com/+https://www.googleapis.com/auth/userinfo.email";
        var client_id = "???";
        var response_type = "code";
        var redirect_uri = window.location.protocol + "//" + window.location.host + "/Gmail/oauth/";
        var url = OAuthUrl + "scope=" + scope + "&client_id=" + client_id + "&redirect_uri=" + redirect_uri + "&response_type=" + response_type;
        var w = window.open(url, "Gmail", "width=800, height=600");
        var timer = setInterval(function () {
            try {
                if (w.document.URL.indexOf(redirect_uri) != -1) {
                    debugger;
                    clearInterval(timer);
                    w.close();
                    var code = w.document.URL.replace(redirect_uri + "?code=", "");
                    console.log(code);
                }
            } catch (e) {
                console.log(e);
            }
        }, 100);
    }
</script>
</body>
</html>